# GAME_SPEC.md

## Spec Version
- **Version:** v1.6.0
- **Project:** Synergy Turn Card Battle
- **Owner Role:** Producer (Game Designer)
- **Language:** Korean
- **Last Updated:** 2026-02-13

## 1) Design Goal
v1.6.0은 **실전형 전투 화면 레이아웃**과 **시너지/적 스케일링 밸런스 리빌드**를 동시에 적용한다.

핵심 목표:
- 플레이어가 한 화면에서 전장/스탯/행동 버튼/손패를 즉시 인지한다.
- 시너지 폭주를 줄이고, 라운드 후반 난이도를 완만하게 조정한다.

## 2) Scope

### Scope In (v1.6.0)
- 상태 머신 유지:
  - `ready`
  - `planning`
  - `playerTurn`
  - `enemyTurn`
  - `resolution`
  - `deckBuild`
  - `routeSelect`
  - `gameOver`
  - `runComplete`
- 전투 UI 재구성:
  - 상단: 배틀 스테이지 캔버스 + VS 오버레이 + 전장 초상 카드.
  - 중단: 플레이어/적/런 정보 스탯 패널 3열 구성.
  - 하단: 전투 조작 + 시너지 안내 + 손패 카드 영역.
- 카드 이미지는 모든 카드에 필수 제공(`image`).
- 시너지/버스트 밸런스 조정.
- 적 스케일링 완화(최종 단계 에너지 과증가 억제).
- 덱 정비(랜덤 보상 3장 + 랜덤 제거 후보 최대 3장) 유지.

### Scope Out
- 상점/맵 탐험 UI/멀티플레이/클라우드 저장.
- 영구 메타 성장.
- 카드 업그레이드 단계.
- 실시간 물리 엔진 기반 애니메이션.

## 3) Core Battle Rules
- 플레이어 HP: **78**
- 에너지: 턴당 3
- 드로우: 턴 시작 5
- 손패 최대: 8
- 방어도: 턴 시작 시 0
- 취약(`vulnerable`)은 턴 시작 시 1 감소
- 동시 KO: 패배
- 런 길이: 10라운드

## 4) Card System
카드 필수 필드:
- `id`, `name`, `family`, `type`, `energyCost`, `baseValue`, `sigil`, `image`, `effect[]`, `description`

문양(`sigil`): Flame / Leaf / Gear / Void

제한:
- Gear 카드의 드로우+에너지 동시 폭주 금지 원칙 유지.
- 카드 효과는 순수 로직 연산으로 처리.

## 5) Synergy & Burst Rules (v1.6.0)
- 동일 문양 2회 이상 사용 시 시너지 활성.
- Flame: 공격 추가 +5
- Leaf: 방어 추가 +7
- Gear: 드로우 +1
- Void: 공격 추가 +3 + 공격 시 흡혈 1
- 같은 문양 4회 사용 시 문양 버스트 1회 발동.
- 버스트 발동 점수: +15

추가 템포 규칙:
- 문양 2종 이상 활성화 시 아드레날린 1회: 에너지 +1, 점수 +8
- 콤보 체인 3 이상 시 프리즘 버스트 1회: 방어 6 + 추가 피해 8, 점수 +12

## 6) Enemy Intent + Scaling Rule
- `planning` 상태에서 적 의도를 확정.
- 의도 교차(공격↔스킬) 및 직전 카드 반복 회피 우선.
- 난이도 단계 = `1 + floor(round / 3)` (최대 4).
- 적 에너지 보너스:
  - 단계 1: +0
  - 단계 2: +1
  - 단계 3: +2
  - 단계 4: +2
- 7라운드부터 적 드로우 +1.
- 적은 가능한 범위에서 에너지를 소진하도록 연속 행동(최대 12회 안전 제한).

## 7) Deck Build + Route Rule
- 라운드 승리 후 `deckBuild` 진입.
- 순서:
  1. 무작위 보상 카드 3장 중 1장 선택 또는 건너뛰기
  2. 무작위 제거 후보(최대 3장) 중 0~1장 제거
  3. `routeSelect`에서 다음 경로 선택
  4. 다음 라운드 진입
- 제거는 덱 5장 이하 시 금지.

## 8) Score Rules
- 플레이어 공격 카드 사용: +9
- 플레이어 스킬 카드 사용: +7
- 문양 버스트 발동: +15
- 라운드 승리: +110
- 고체력(HP 36+) 승리: +25
- 덱 정리(카드 제거) 성공: +6
- 런 클리어: +200
- 패배: 최종 점수 0

## 9) Required Files
- `index.html`
- `style.css`
- `game.js`
- `hall.html`
- `hall.js`
- `src/storage.js`

## Change Log

### v1.6.0 (2026-02-13)
- 전투 화면을 실전형 레이아웃(상단 전장 / 중단 스탯 / 하단 손패)으로 재정렬했다.
- 플레이어 기본 HP를 78로 조정하고 점수 공식을 재조정했다.
- 문양 시너지 수치(Flame/Leaf/Void)와 버스트 트리거를 4회 기준으로 리밸런싱했다.
- 아드레날린/프리즘 보너스 수치를 하향해 폭주 콤보 빈도를 낮췄다.
- 적 스케일링의 최종 에너지 보너스를 +2로 캡해 후반 난이도 급등을 완화했다.

### v1.5.1 (2026-02-13)
- 적 14종 각각에 대응하는 SVG 기반 전장 초상화를 추가해 전투 오버레이에서 적 정체성을 즉시 확인할 수 있도록 했다.
- 플레이어/적 오버레이 카드에 초상 이미지를 배치해 HP 바만 보이던 영역의 정보 부족 문제를 개선했다.
- 모바일 레이아웃에서 전장 오버레이 요소가 가려지던 문제를 방지하도록 최소 높이/정렬 규칙을 보강했다.
